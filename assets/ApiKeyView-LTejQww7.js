import{d as s,Q as e,s as a,j as t,c as l,b as o,a as d,E as i,h as c,R as n,z as u,y as p,G as r,S as m,F as v,r as A,t as b,u as f,e as y,_ as I}from"./index-B9uMmlVc.js";const h={class:"page-container"},g={class:"content-card"},P={class:"form-group"},C={class:"form-label"},k=["disabled"],x=["disabled"],E={class:"model-selection-wrapper"},K=["disabled"],M=["value"],O=["disabled"],V={key:0},_={key:1},U={class:"form-hint"},w={key:0,class:"error-text"},S={key:1,class:"debug-text"},$={key:2},j=I(s({__name:"ApiKeyView",setup(s){const I=f(),j=e(),{fetchAvailableModels:q,updateSettings:z,resetSettings:F}=j,{settings:G,isLoadingModels:L,error:Q}=a(j),R=t(null);async function B(){if(!G.value.customApiKey||!G.value.customApiEndpoint)return void(Q.value="请先填写API密钥和端点");R.value=`正在从 ${G.value.customApiEndpoint} 获取模型列表...`;const s=await q(G.value.customApiEndpoint,G.value.customApiKey);s&&s.length>0?(R.value=`成功获取到 ${s.length} 个模型`,s.includes(G.value.selectedModel)||(G.value.selectedModel=s[0])):R.value="获取模型列表失败或列表为空。"}function D(){try{z(G.value),alert("设置已保存"),I.push("/")}catch(s){alert(`保存设置失败: ${s instanceof Error?s.message:"未知错误"}`)}}function H(){F(),alert("设置已重置")}return(s,e)=>(y(),l("div",h,[e[12]||(e[12]=o("h1",{class:"page-title"},"配置 Key ⚙️",-1)),o("div",g,[e[11]||(e[11]=o("h2",{class:"section-title"},"API 配置",-1)),o("div",P,[o("label",C,[i(o("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>u(G).useCustomApi=s),type:"checkbox",class:"form-checkbox"},null,512),[[n,u(G).useCustomApi]]),e[4]||(e[4]=c(" 启用自定义 API "))]),e[5]||(e[5]=o("div",{class:"form-hint"},"启用后将使用您自己的 API，否则使用内置 AI 服务",-1))]),o("div",{class:p(["form-group",{"form-disabled":!u(G).useCustomApi}])},[e[6]||(e[6]=o("label",{class:"form-label"},"API 密钥",-1)),i(o("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>u(G).customApiKey=s),type:"text",class:"form-input",placeholder:"输入您的 API Key",disabled:!u(G).useCustomApi},null,8,k),[[r,u(G).customApiKey]]),e[7]||(e[7]=o("div",{class:"form-hint"},"请输入与 OpenAI 格式兼容的 API 密钥",-1))],2),o("div",{class:p(["form-group",{"form-disabled":!u(G).useCustomApi}])},[e[8]||(e[8]=o("label",{class:"form-label"},"API 端点",-1)),i(o("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>u(G).customApiEndpoint=s),type:"text",class:"form-input",placeholder:"https://api.example.com/v1",disabled:!u(G).useCustomApi},null,8,x),[[r,u(G).customApiEndpoint]]),e[9]||(e[9]=o("div",{class:"form-hint"},"请输入基础API地址，系统会自动添加 /chat/completions 路径",-1))],2),o("div",{class:p(["form-group",{"form-disabled":!u(G).useCustomApi}])},[e[10]||(e[10]=o("label",{class:"form-label"},"选择模型",-1)),o("div",E,[i(o("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>u(G).selectedModel=s),class:"form-select",disabled:!u(G).useCustomApi},[(y(!0),l(v,null,A(u(G).availableModels,s=>(y(),l("option",{key:s,value:s},b(s),9,M))),128))],8,K),[[m,u(G).selectedModel]]),o("button",{class:p(["btn-primary fetch-models-button",{loading:u(L)}]),disabled:!u(G).useCustomApi||!u(G).customApiKey||!u(G).customApiEndpoint||u(L),onClick:B},[u(L)?(y(),l("span",V,"加载中...")):(y(),l("span",_,"获取模型列表"))],10,O)]),o("div",U,[u(Q)?(y(),l("span",w,b(u(Q)),1)):u(R)?(y(),l("span",S,b(u(R)),1)):(y(),l("span",$,"选择要使用的模型，或从您的API提供商获取可用模型列表"))])],2),o("div",{class:"form-actions"},[o("button",{class:"btn-primary",onClick:D},"保存设置"),o("button",{class:"btn-secondary",onClick:H},"重置")])]),e[13]||(e[13]=d('<div class="content-card" data-v-9544d0c1><h2 class="section-title" data-v-9544d0c1>使用说明</h2><div class="info-content" data-v-9544d0c1><p data-v-9544d0c1>您可以配置兼容 OpenAI 格式的 API，包括但不限于：</p><ul data-v-9544d0c1><li data-v-9544d0c1>OpenAI API</li><li data-v-9544d0c1>Azure OpenAI</li><li data-v-9544d0c1>自托管的开源模型 API</li><li data-v-9544d0c1>其他兼容 OpenAI 格式的 API 服务</li></ul><p data-v-9544d0c1><strong data-v-9544d0c1>注意：</strong> API 密钥将安全地存储在您的浏览器本地，不会发送到我们的服务器。 </p><p data-v-9544d0c1><strong data-v-9544d0c1>模型获取：</strong> 点击&quot;获取模型列表&quot;按钮将从您配置的API端点获取可用的模型列表。 如果获取失败，将使用默认模型列表。 </p></div></div>',1))]))}}),[["__scopeId","data-v-9544d0c1"]]);export{j as default};
