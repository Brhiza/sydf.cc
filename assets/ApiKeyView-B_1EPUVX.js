import{d as s,N as e,r as l,c as a,a as t,j as o,h as i,O as n,u,n as c,v as d,k as p,F as r,l as m,t as A,x as v,o as b}from"./vendor-DpgQG9eY.js";import{u as f,_ as y}from"./index-DCC_W_4a.js";import"./utils-B-ODjm7Z.js";const h={class:"page-container"},g={class:"content-card"},I={class:"form-group"},P={class:"form-label"},k=["disabled"],C=["disabled"],x={class:"model-selection-wrapper"},K=["disabled"],E=["value"],M=["disabled"],V={key:0},_={key:1},j={class:"form-hint"},U={key:0,class:"error-text"},w={key:1,class:"debug-text"},O={key:2},$=y(s({__name:"ApiKeyView",setup(s){const y=v(),$=f(),{fetchAvailableModels:S,updateSettings:F,resetSettings:L}=$,{settings:N,isLoadingModels:q,error:z}=e($),B=l(null);async function D(){if(!N.value.customApiKey||!N.value.customApiEndpoint)return void(z.value="请先填写API密钥和端点");B.value=`正在从 ${N.value.customApiEndpoint} 获取模型列表...`;const s=await S(N.value.customApiEndpoint,N.value.customApiKey);s&&s.length>0?(B.value=`成功获取到 ${s.length} 个模型`,s.includes(N.value.selectedModel)||(N.value.selectedModel=s[0])):B.value="获取模型列表失败或列表为空。"}function G(){try{F(N.value),alert("设置已保存"),y.push("/")}catch(s){alert(`保存设置失败: ${s instanceof Error?s.message:"未知错误"}`)}}function H(){L(),alert("设置已重置")}return(s,e)=>(b(),a("div",h,[e[12]||(e[12]=t("h1",{class:"page-title"},"配置 Key ⚙️",-1)),t("div",g,[e[11]||(e[11]=t("h2",{class:"section-title"},"API 配置",-1)),t("div",I,[t("label",P,[o(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>u(N).useCustomApi=s),type:"checkbox",class:"form-checkbox"},null,512),[[n,u(N).useCustomApi]]),e[4]||(e[4]=i(" 启用自定义 API ",-1))]),e[5]||(e[5]=t("div",{class:"form-hint"},"启用后将使用您自己的 API，否则使用内置 AI 服务",-1))]),t("div",{class:c(["form-group",{"form-disabled":!u(N).useCustomApi}])},[e[6]||(e[6]=t("label",{class:"form-label"},"API 密钥",-1)),o(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>u(N).customApiKey=s),type:"text",class:"form-input",placeholder:"输入您的 API Key",disabled:!u(N).useCustomApi},null,8,k),[[d,u(N).customApiKey]]),e[7]||(e[7]=t("div",{class:"form-hint"},"请输入与 OpenAI 格式兼容的 API 密钥",-1))],2),t("div",{class:c(["form-group",{"form-disabled":!u(N).useCustomApi}])},[e[8]||(e[8]=t("label",{class:"form-label"},"API 端点",-1)),o(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>u(N).customApiEndpoint=s),type:"text",class:"form-input",placeholder:"https://api.example.com/v1",disabled:!u(N).useCustomApi},null,8,C),[[d,u(N).customApiEndpoint]]),e[9]||(e[9]=t("div",{class:"form-hint"},"请输入基础API地址，系统会自动添加 /chat/completions 路径",-1))],2),t("div",{class:c(["form-group",{"form-disabled":!u(N).useCustomApi}])},[e[10]||(e[10]=t("label",{class:"form-label"},"选择模型",-1)),t("div",x,[o(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>u(N).selectedModel=s),class:"form-select",disabled:!u(N).useCustomApi},[(b(!0),a(r,null,m(u(N).availableModels,s=>(b(),a("option",{key:s,value:s},A(s),9,E))),128))],8,K),[[p,u(N).selectedModel]]),t("button",{class:c(["btn-primary fetch-models-button",{loading:u(q)}]),disabled:!u(N).useCustomApi||!u(N).customApiKey||!u(N).customApiEndpoint||u(q),onClick:D},[u(q)?(b(),a("span",V,"加载中...")):(b(),a("span",_,"获取模型列表"))],10,M)]),t("div",j,[u(z)?(b(),a("span",U,A(u(z)),1)):B.value?(b(),a("span",w,A(B.value),1)):(b(),a("span",O,"选择要使用的模型，或从您的API提供商获取可用模型列表"))])],2),t("div",{class:"form-actions"},[t("button",{class:"btn-primary",onClick:G},"保存设置"),t("button",{class:"btn-secondary",onClick:H},"重置")])]),e[13]||(e[13]=t("div",{class:"content-card"},[t("h2",{class:"section-title"},"使用说明"),t("div",{class:"info-content"},[t("p",null,"您可以配置所有兼容 OpenAI 格式的 API"),t("p",null,[t("strong",null,"注意："),i(" API 密钥将安全地存储在您的浏览器本地，不会发送到我们的服务器。 ")]),t("p",null,[t("strong",null,"模型获取："),i(' 点击"获取模型列表"按钮将从您配置的API端点获取可用的模型列表。 如果获取失败，将使用默认模型列表。 ')])])],-1))]))}}),[["__scopeId","data-v-84951bd4"]]);export{$ as default};
