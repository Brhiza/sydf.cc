import{d as t,r as a,o as s,c as l,b as n,h as e,t as o,n as i,g as r,F as c,l as u,e as d}from"./vendor.BOsypETj.js";import{_ as v}from"./index.C-qxr2xH.js";import"./utils.CwRxlNlL.js";const h={class:"page-container"},g={class:"content-card"},p={class:"stats-container"},m={class:"stat-item"},f={class:"stat-number"},b={class:"stat-item"},y={class:"stat-number"},k={class:"stat-item"},w={class:"stat-number"},j={class:"content-card"},L={class:"section-header"},_={class:"section-title"},D=["disabled","title"],M={class:"table-container"},x={class:"donation-table"},z={key:0,class:"anonymous-badge"},T={key:1},$={class:"amount-cell"},A={class:"note-cell"},B={key:0},C={class:"total-row"},S={class:"amount-cell"},E={colspan:"2"},F={key:0,class:"empty-state"},G=v(t({__name:"GongdeBoardView",setup(t){const v=a([]),G=a({url:"https://cdn.jsdelivr.net/gh/Brhiza/sydfjuanzeng@main/juanzeng.json",isLoading:!1,error:null});function H(t){return`¥${t.toLocaleString()}`}function I(){const t=v.value.reduce((t,a)=>t+a.amount,0);return Math.round(100*t)/100}function N(){return v.value.length}async function P(){G.value.isLoading=!0,G.value.error=null;try{const t=Date.now(),a=`${G.value.url}?_t=${t}`,s=await fetch(a,{cache:"no-cache"});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const l=await s.json();v.value=l}catch(t){G.value.error="获取远程数据失败，使用本地数据"}finally{G.value.isLoading=!1}}function V(t){t.preventDefault()}function q(t){t.preventDefault(),P()}return s(()=>{P()}),(t,a)=>(d(),l("div",h,[a[10]||(a[10]=n("h1",{class:"page-title"},"功德榜 🏆",-1)),n("div",g,[a[3]||(a[3]=n("h2",{class:"section-title"},[e("功德统计 "),n("span",{class:"highlight-text"},"爱心汇聚")],-1)),n("div",p,[n("div",m,[n("div",f,o(I()),1),a[0]||(a[0]=n("div",{class:"stat-label"},"总捐赠额 (元)",-1))]),n("div",b,[n("div",y,o(N()),1),a[1]||(a[1]=n("div",{class:"stat-label"},"捐赠人数",-1))]),n("div",k,[n("div",w,o(Math.round(I()/N())),1),a[2]||(a[2]=n("div",{class:"stat-label"},"人均捐赠 (元)",-1))])])]),n("div",j,[n("div",L,[n("h2",_,[a[5]||(a[5]=e(" 捐赠记录 ",-1)),n("button",{class:"refresh-button",disabled:G.value.isLoading,title:G.value.isLoading?"正在刷新...":"点击刷新数据",type:"button",onClick:P,onTouchstart:V,onTouchend:q},[(d(),l("svg",{class:i(["refresh-icon",{rotating:G.value.isLoading}]),viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[...a[4]||(a[4]=[n("path",{d:"M1 4v6h6M23 20v-6h-6"},null,-1),n("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"},null,-1)])],2))],40,D)])]),a[9]||(a[9]=n("div",{class:"refresh-notice"},[n("p",null,"💡 数据更新可能存在延迟，如需查看最新捐赠记录，请点击上方刷新按钮")],-1)),n("div",M,[n("table",x,[a[7]||(a[7]=n("thead",null,[n("tr",null,[n("th",null,"序号"),n("th",null,"捐赠人"),n("th",null,"金额"),n("th",null,"日期"),n("th",null,"备注")])],-1)),n("tbody",null,[(d(!0),l(c,null,u(v.value,(t,a)=>{return d(),l("tr",{key:t.id},[n("td",null,o(a+1),1),n("td",null,[t.isAnonymous?(d(),l("span",z,"🙈 匿名")):(d(),l("span",T,o(t.name),1))]),n("td",$,o(H(t.amount)),1),n("td",null,o((s=t.date,new Date(s).toLocaleDateString("zh-CN"))),1),n("td",A,o(t.note||"-"),1)]);var s}),128))]),v.value.length>0?(d(),l("tfoot",B,[n("tr",C,[a[6]||(a[6]=n("td",{colspan:"2"},[n("strong",null,"总计")],-1)),n("td",S,[n("strong",null,o(H(I())),1)]),n("td",E,[n("strong",null,o(N())+" 位捐赠人",1)])])])):r("",!0)]),0===v.value.length?(d(),l("div",F,[...a[8]||(a[8]=[n("div",{class:"empty-icon"},"📋",-1),n("p",null,"暂无捐赠记录",-1)])])):r("",!0)])])]))}}),[["__scopeId","data-v-7d88fcbc"]]);export{G as default};
