import{d as e,Q as s,R as a,l,c as t,b as o,a as c,y as i,h as n,S as d,s as u,n as p,z as r,T as m,F as v,r as b,t as A,u as f,e as y,_ as I}from"./index-C6bcNFFY.js";const h={class:"page-container"},g={class:"content-card"},P={class:"form-group"},C={class:"form-label"},k=["disabled"],x=["disabled"],K={class:"model-selection-wrapper"},E=["disabled"],M=["value"],O=["disabled"],V={key:0},_={key:1},U={class:"form-hint"},w={key:0,class:"error-text"},S={key:1,class:"debug-text"},$={key:2},q=I(e({__name:"ApiKeyView",setup(e){const I=f(),q=s(),{fetchAvailableModels:z,updateSettings:j,resetSettings:F}=q,{settings:L,isLoadingModels:Q,error:R}=a(q),T=l(null);async function B(){if(!L.value.customApiKey||!L.value.customApiEndpoint)return void(R.value="请先填写API密钥和端点");T.value=`正在从 ${L.value.customApiEndpoint} 获取模型列表...`;const e=await z(L.value.customApiEndpoint,L.value.customApiKey);e&&e.length>0?(T.value=`成功获取到 ${e.length} 个模型`,e.includes(L.value.selectedModel)||(L.value.selectedModel=e[0])):T.value="获取模型列表失败或列表为空。"}function D(){try{j(L.value),alert("设置已保存"),I.push("/")}catch(e){alert(`保存设置失败: ${e instanceof Error?e.message:"未知错误"}`)}}function G(){F(),alert("设置已重置")}return(e,s)=>(y(),t("div",h,[s[12]||(s[12]=o("h1",{class:"page-title"},"配置 Key ⚙️",-1)),o("div",g,[s[11]||(s[11]=o("h2",{class:"section-title"},"API 配置",-1)),o("div",P,[o("label",C,[i(o("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>u(L).useCustomApi=e),type:"checkbox",class:"form-checkbox"},null,512),[[d,u(L).useCustomApi]]),s[4]||(s[4]=n(" 启用自定义 API ",-1))]),s[5]||(s[5]=o("div",{class:"form-hint"},"启用后将使用您自己的 API，否则使用内置 AI 服务",-1))]),o("div",{class:p(["form-group",{"form-disabled":!u(L).useCustomApi}])},[s[6]||(s[6]=o("label",{class:"form-label"},"API 密钥",-1)),i(o("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>u(L).customApiKey=e),type:"text",class:"form-input",placeholder:"输入您的 API Key",disabled:!u(L).useCustomApi},null,8,k),[[r,u(L).customApiKey]]),s[7]||(s[7]=o("div",{class:"form-hint"},"请输入与 OpenAI 格式兼容的 API 密钥",-1))],2),o("div",{class:p(["form-group",{"form-disabled":!u(L).useCustomApi}])},[s[8]||(s[8]=o("label",{class:"form-label"},"API 端点",-1)),i(o("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>u(L).customApiEndpoint=e),type:"text",class:"form-input",placeholder:"https://api.example.com/v1",disabled:!u(L).useCustomApi},null,8,x),[[r,u(L).customApiEndpoint]]),s[9]||(s[9]=o("div",{class:"form-hint"},"请输入基础API地址，系统会自动添加 /chat/completions 路径",-1))],2),o("div",{class:p(["form-group",{"form-disabled":!u(L).useCustomApi}])},[s[10]||(s[10]=o("label",{class:"form-label"},"选择模型",-1)),o("div",K,[i(o("select",{"onUpdate:modelValue":s[3]||(s[3]=e=>u(L).selectedModel=e),class:"form-select",disabled:!u(L).useCustomApi},[(y(!0),t(v,null,b(u(L).availableModels,e=>(y(),t("option",{key:e,value:e},A(e),9,M))),128))],8,E),[[m,u(L).selectedModel]]),o("button",{class:p(["btn-primary fetch-models-button",{loading:u(Q)}]),disabled:!u(L).useCustomApi||!u(L).customApiKey||!u(L).customApiEndpoint||u(Q),onClick:B},[u(Q)?(y(),t("span",V,"加载中...")):(y(),t("span",_,"获取模型列表"))],10,O)]),o("div",U,[u(R)?(y(),t("span",w,A(u(R)),1)):T.value?(y(),t("span",S,A(T.value),1)):(y(),t("span",$,"选择要使用的模型，或从您的API提供商获取可用模型列表"))])],2),o("div",{class:"form-actions"},[o("button",{class:"btn-primary",onClick:D},"保存设置"),o("button",{class:"btn-secondary",onClick:G},"重置")])]),s[13]||(s[13]=c('<div class="content-card" data-v-b8e618cc><h2 class="section-title" data-v-b8e618cc>使用说明</h2><div class="info-content" data-v-b8e618cc><p data-v-b8e618cc>您可以配置兼容 OpenAI 格式的 API，包括但不限于：</p><ul data-v-b8e618cc><li data-v-b8e618cc>OpenAI API</li><li data-v-b8e618cc>Azure OpenAI</li><li data-v-b8e618cc>自托管的开源模型 API</li><li data-v-b8e618cc>其他兼容 OpenAI 格式的 API 服务</li></ul><p data-v-b8e618cc><strong data-v-b8e618cc>注意：</strong> API 密钥将安全地存储在您的浏览器本地，不会发送到我们的服务器。 </p><p data-v-b8e618cc><strong data-v-b8e618cc>模型获取：</strong> 点击&quot;获取模型列表&quot;按钮将从您配置的API端点获取可用的模型列表。 如果获取失败，将使用默认模型列表。 </p></div></div>',1))]))}}),[["__scopeId","data-v-b8e618cc"]]);export{q as default};
