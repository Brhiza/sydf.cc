import{d as e,N as s,r as a,c as t,a as l,E as o,j as i,h as n,O as d,u,n as c,v as p,k as r,F as m,l as v,t as f,x as A,o as b}from"./vendor-DpgQG9eY.js";import{u as I,_ as y}from"./index-BEymrLkf.js";import"./utils-B-ODjm7Z.js";const h={class:"page-container"},g={class:"content-card"},P={class:"form-group"},k={class:"form-label"},C=["disabled"],x=["disabled"],E={class:"model-selection-wrapper"},K=["disabled"],M=["value"],O=["disabled"],V={key:0},_={key:1},j={class:"form-hint"},U={key:0,class:"error-text"},w={key:1,class:"debug-text"},$={key:2},q=y(e({__name:"ApiKeyView",setup(e){const y=A(),q=I(),{fetchAvailableModels:S,updateSettings:z,resetSettings:F}=q,{settings:L,isLoadingModels:N,error:B}=s(q),D=a(null);async function G(){if(!L.value.customApiKey||!L.value.customApiEndpoint)return void(B.value="请先填写API密钥和端点");D.value=`正在从 ${L.value.customApiEndpoint} 获取模型列表...`;const e=await S(L.value.customApiEndpoint,L.value.customApiKey);e&&e.length>0?(D.value=`成功获取到 ${e.length} 个模型`,e.includes(L.value.selectedModel)||(L.value.selectedModel=e[0])):D.value="获取模型列表失败或列表为空。"}function H(){try{z(L.value),alert("设置已保存"),y.push("/")}catch(e){alert(`保存设置失败: ${e instanceof Error?e.message:"未知错误"}`)}}function J(){F(),alert("设置已重置")}return(e,s)=>(b(),t("div",h,[s[12]||(s[12]=l("h1",{class:"page-title"},"配置 Key ⚙️",-1)),l("div",g,[s[11]||(s[11]=l("h2",{class:"section-title"},"API 配置",-1)),l("div",P,[l("label",k,[i(l("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>u(L).useCustomApi=e),type:"checkbox",class:"form-checkbox"},null,512),[[d,u(L).useCustomApi]]),s[4]||(s[4]=n(" 启用自定义 API ",-1))]),s[5]||(s[5]=l("div",{class:"form-hint"},"启用后将使用您自己的 API，否则使用内置 AI 服务",-1))]),l("div",{class:c(["form-group",{"form-disabled":!u(L).useCustomApi}])},[s[6]||(s[6]=l("label",{class:"form-label"},"API 密钥",-1)),i(l("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>u(L).customApiKey=e),type:"text",class:"form-input",placeholder:"输入您的 API Key",disabled:!u(L).useCustomApi},null,8,C),[[p,u(L).customApiKey]]),s[7]||(s[7]=l("div",{class:"form-hint"},"请输入与 OpenAI 格式兼容的 API 密钥",-1))],2),l("div",{class:c(["form-group",{"form-disabled":!u(L).useCustomApi}])},[s[8]||(s[8]=l("label",{class:"form-label"},"API 端点",-1)),i(l("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>u(L).customApiEndpoint=e),type:"text",class:"form-input",placeholder:"https://api.example.com/v1",disabled:!u(L).useCustomApi},null,8,x),[[p,u(L).customApiEndpoint]]),s[9]||(s[9]=l("div",{class:"form-hint"},"请输入基础API地址，系统会自动添加 /chat/completions 路径",-1))],2),l("div",{class:c(["form-group",{"form-disabled":!u(L).useCustomApi}])},[s[10]||(s[10]=l("label",{class:"form-label"},"选择模型",-1)),l("div",E,[i(l("select",{"onUpdate:modelValue":s[3]||(s[3]=e=>u(L).selectedModel=e),class:"form-select",disabled:!u(L).useCustomApi},[(b(!0),t(m,null,v(u(L).availableModels,e=>(b(),t("option",{key:e,value:e},f(e),9,M))),128))],8,K),[[r,u(L).selectedModel]]),l("button",{class:c(["btn-primary fetch-models-button",{loading:u(N)}]),disabled:!u(L).useCustomApi||!u(L).customApiKey||!u(L).customApiEndpoint||u(N),onClick:G},[u(N)?(b(),t("span",V,"加载中...")):(b(),t("span",_,"获取模型列表"))],10,O)]),l("div",j,[u(B)?(b(),t("span",U,f(u(B)),1)):D.value?(b(),t("span",w,f(D.value),1)):(b(),t("span",$,"选择要使用的模型，或从您的API提供商获取可用模型列表"))])],2),l("div",{class:"form-actions"},[l("button",{class:"btn-primary",onClick:H},"保存设置"),l("button",{class:"btn-secondary",onClick:J},"重置")])]),s[13]||(s[13]=o('<div class="content-card" data-v-77f246ee><h2 class="section-title" data-v-77f246ee>使用说明</h2><div class="info-content" data-v-77f246ee><p data-v-77f246ee>您可以配置兼容 OpenAI 格式的 API，包括但不限于：</p><ul data-v-77f246ee><li data-v-77f246ee>OpenAI API</li><li data-v-77f246ee>Azure OpenAI</li><li data-v-77f246ee>自托管的开源模型 API</li><li data-v-77f246ee>其他兼容 OpenAI 格式的 API 服务</li></ul><p data-v-77f246ee><strong data-v-77f246ee>注意：</strong> API 密钥将安全地存储在您的浏览器本地，不会发送到我们的服务器。 </p><p data-v-77f246ee><strong data-v-77f246ee>模型获取：</strong> 点击&quot;获取模型列表&quot;按钮将从您配置的API端点获取可用的模型列表。 如果获取失败，将使用默认模型列表。 </p></div></div>',1))]))}}),[["__scopeId","data-v-77f246ee"]]);export{q as default};
