import{d as a,O as s,P as e,l,c as t,b as o,a as d,y as i,h as c,Q as n,s as u,n as p,z as r,R as f,F as m,r as v,t as A,u as b,e as y,_ as I}from"./index-ScSiA0UQ.js";const h={class:"page-container"},g={class:"content-card"},P={class:"form-group"},C={class:"form-label"},k=["disabled"],x=["disabled"],K={class:"model-selection-wrapper"},E=["disabled"],M=["value"],O=["disabled"],V={key:0},_={key:1},U={class:"form-hint"},w={key:0,class:"error-text"},$={key:1,class:"debug-text"},q={key:2},z=I(a({__name:"ApiKeyView",setup(a){const I=b(),z=s(),{fetchAvailableModels:S,updateSettings:j,resetSettings:F}=z,{settings:L,isLoadingModels:Q,error:R}=e(z),B=l(null);async function D(){if(!L.value.customApiKey||!L.value.customApiEndpoint)return void(R.value="请先填写API密钥和端点");B.value=`正在从 ${L.value.customApiEndpoint} 获取模型列表...`;const a=await S(L.value.customApiEndpoint,L.value.customApiKey);a&&a.length>0?(B.value=`成功获取到 ${a.length} 个模型`,a.includes(L.value.selectedModel)||(L.value.selectedModel=a[0])):B.value="获取模型列表失败或列表为空。"}function G(){try{j(L.value),alert("设置已保存"),I.push("/")}catch(a){alert(`保存设置失败: ${a instanceof Error?a.message:"未知错误"}`)}}function H(){F(),alert("设置已重置")}return(a,s)=>(y(),t("div",h,[s[12]||(s[12]=o("h1",{class:"page-title"},"配置 Key ⚙️",-1)),o("div",g,[s[11]||(s[11]=o("h2",{class:"section-title"},"API 配置",-1)),o("div",P,[o("label",C,[i(o("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>u(L).useCustomApi=a),type:"checkbox",class:"form-checkbox"},null,512),[[n,u(L).useCustomApi]]),s[4]||(s[4]=c(" 启用自定义 API ",-1))]),s[5]||(s[5]=o("div",{class:"form-hint"},"启用后将使用您自己的 API，否则使用内置 AI 服务",-1))]),o("div",{class:p(["form-group",{"form-disabled":!u(L).useCustomApi}])},[s[6]||(s[6]=o("label",{class:"form-label"},"API 密钥",-1)),i(o("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>u(L).customApiKey=a),type:"text",class:"form-input",placeholder:"输入您的 API Key",disabled:!u(L).useCustomApi},null,8,k),[[r,u(L).customApiKey]]),s[7]||(s[7]=o("div",{class:"form-hint"},"请输入与 OpenAI 格式兼容的 API 密钥",-1))],2),o("div",{class:p(["form-group",{"form-disabled":!u(L).useCustomApi}])},[s[8]||(s[8]=o("label",{class:"form-label"},"API 端点",-1)),i(o("input",{"onUpdate:modelValue":s[2]||(s[2]=a=>u(L).customApiEndpoint=a),type:"text",class:"form-input",placeholder:"https://api.example.com/v1",disabled:!u(L).useCustomApi},null,8,x),[[r,u(L).customApiEndpoint]]),s[9]||(s[9]=o("div",{class:"form-hint"},"请输入基础API地址，系统会自动添加 /chat/completions 路径",-1))],2),o("div",{class:p(["form-group",{"form-disabled":!u(L).useCustomApi}])},[s[10]||(s[10]=o("label",{class:"form-label"},"选择模型",-1)),o("div",K,[i(o("select",{"onUpdate:modelValue":s[3]||(s[3]=a=>u(L).selectedModel=a),class:"form-select",disabled:!u(L).useCustomApi},[(y(!0),t(m,null,v(u(L).availableModels,a=>(y(),t("option",{key:a,value:a},A(a),9,M))),128))],8,E),[[f,u(L).selectedModel]]),o("button",{class:p(["btn-primary fetch-models-button",{loading:u(Q)}]),disabled:!u(L).useCustomApi||!u(L).customApiKey||!u(L).customApiEndpoint||u(Q),onClick:D},[u(Q)?(y(),t("span",V,"加载中...")):(y(),t("span",_,"获取模型列表"))],10,O)]),o("div",U,[u(R)?(y(),t("span",w,A(u(R)),1)):B.value?(y(),t("span",$,A(B.value),1)):(y(),t("span",q,"选择要使用的模型，或从您的API提供商获取可用模型列表"))])],2),o("div",{class:"form-actions"},[o("button",{class:"btn-primary",onClick:G},"保存设置"),o("button",{class:"btn-secondary",onClick:H},"重置")])]),s[13]||(s[13]=d('<div class="content-card" data-v-7cdfa50f><h2 class="section-title" data-v-7cdfa50f>使用说明</h2><div class="info-content" data-v-7cdfa50f><p data-v-7cdfa50f>您可以配置兼容 OpenAI 格式的 API，包括但不限于：</p><ul data-v-7cdfa50f><li data-v-7cdfa50f>OpenAI API</li><li data-v-7cdfa50f>Azure OpenAI</li><li data-v-7cdfa50f>自托管的开源模型 API</li><li data-v-7cdfa50f>其他兼容 OpenAI 格式的 API 服务</li></ul><p data-v-7cdfa50f><strong data-v-7cdfa50f>注意：</strong> API 密钥将安全地存储在您的浏览器本地，不会发送到我们的服务器。 </p><p data-v-7cdfa50f><strong data-v-7cdfa50f>模型获取：</strong> 点击&quot;获取模型列表&quot;按钮将从您配置的API端点获取可用的模型列表。 如果获取失败，将使用默认模型列表。 </p></div></div>',1))]))}}),[["__scopeId","data-v-7cdfa50f"]]);export{z as default};
