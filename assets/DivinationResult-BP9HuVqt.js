import{d as a}from"./markdown-BrxPKiid.js";import{d as e,i as s,r as n,p as t,c as l,a as i,g as r,o,y as d,t as c,n as u,L as p,m,G as g,q as v,F as y,l as h,u as f,M as k}from"./vendor-DpgQG9eY.js";import{_ as x,L as A}from"./index-NMQ6A3-Q.js";const _={class:"markdown-content streaming-markdown-content"},$=["innerHTML"],I=["innerHTML"],w=x(e({__name:"StreamingMarkdown",props:{content:{},isComplete:{type:Boolean,default:!1}},setup(e){const d=e,c=s(()=>"string"==typeof d.content?d.content:d.content.value),u=n(""),p=n(""),m=n(!1);return a.setOptions({breaks:!0,gfm:!0}),t([c,()=>d.isComplete],async([e,s],[n,t])=>{let l="",i="",r=!1;const o=["think","thinking","reason","analyze","reflect"],d=o.map(a=>`<${a}>|</${a}>`).join("|"),c=e.split(new RegExp(`(${d})`,"g"));let g="";for(const u of c){const e=u.match(/^<(\w+)>$/),n=u.match(/^<\/(\w+)>$/);if(e&&o.includes(e[1]))r=!0,g=e[1],i="";else if(n&&o.includes(n[1])){if(r&&g===n[1]){const e=await a.parse(i);l+=s?`<details class="thinking-${g}"><summary>${{think:"查看AI的思考过程",thinking:"查看AI的详细思考",reason:"查看AI的推理过程",analyze:"查看AI的分析过程",reflect:"查看AI的反思过程"}[g]}</summary><div class="thinking-content">${e}</div></details>`:`<details open class="thinking-${g}"><summary>${{think:"AI正在思考...",thinking:"AI正在详细思考...",reason:"AI正在推理...",analyze:"AI正在分析...",reflect:"AI正在反思..."}[g]}</summary><div class="thinking-content">${e}</div></details>`,r=!1,g=""}else if(!r){i=l,l="";const e=await a.parse(i),s=n[1];l+=`<details class="thinking-${s}"><summary>${{think:"查看AI的思考过程",thinking:"查看AI的详细思考",reason:"查看AI的推理过程",analyze:"查看AI的分析过程",reflect:"查看AI的反思过程"}[s]||"查看AI的思考过程"}</summary><div class="thinking-content">${e}</div></details>`,i=""}}else u&&(r?i+=u:l+=await a.parse(u))}r?(u.value=l,p.value=await a.parse(i),m.value=!0):(u.value=l,p.value="",m.value=!1)},{immediate:!0}),(a,e)=>(o(),l("div",_,[i("div",{innerHTML:u.value},null,8,$),m.value?(o(),l("div",{key:0,class:"thinking-bubble",innerHTML:p.value},null,8,I)):r("",!0)]))}}),[["__scopeId","data-v-c1dd06dc"]]);function b(a){return{formatSolarTime:s(()=>{let e=a.value.timestamp;if(!e){if("timeInfo"in a.value&&a.value.timeInfo&&"object"==typeof a.value.timeInfo&&"solar"in a.value.timeInfo){const e=a.value.timeInfo.solar;return`${e.year}年${e.month}月${e.day}日${e.hour}时${e.minute}分`}return""}const s=new Date(e);return`${s.getFullYear()}年${s.getMonth()+1}月${s.getDate()}日${s.getHours()}时${s.getMinutes()}分`}),formatGanZhi:s(()=>{if(!a.value.ganzhi)return"";const{year:e,month:s,day:n,hour:t}=a.value.ganzhi;return`${e}年 ${s}月 ${n}日 ${t}时`})}}function T(a){return{reversedYaosDetail:s(()=>a.value.yaosDetail?[...a.value.yaosDetail].reverse():[])}}const z={class:"result-header"},H={key:0,class:"info-line"},L={class:"info-value"},Y={key:1,class:"info-line"},N={class:"info-value"},j=x(e({__name:"ResultHeader",props:{solarTime:{},ganzhiTime:{}},setup:a=>(a,e)=>(o(),l("div",z,[a.solarTime?(o(),l("div",H,[e[0]||(e[0]=i("span",{class:"info-label"},"公历时间：",-1)),i("span",L,c(a.solarTime),1)])):r("",!0),a.ganzhiTime?(o(),l("div",Y,[e[1]||(e[1]=i("span",{class:"info-label"},"干支：",-1)),i("span",N,c(a.ganzhiTime),1)])):r("",!0),d(a.$slots,"default",{},void 0)]))}),[["__scopeId","data-v-6322c7c2"]]),D={key:0,class:"yang-line"},M={key:1,class:"yin-line"},C=x(e({__name:"YaoSymbol",props:{yaoType:{},isMain:{type:Boolean,default:!0}},setup:a=>(a,e)=>(o(),l("div",{class:u(["yao-symbol",{"main-yao":a.isMain,"changed-yao":!a.isMain}])},["阳"===a.yaoType?(o(),l("div",D)):"阴"===a.yaoType?(o(),l("div",M,[...e[0]||(e[0]=[i("div",{class:"yin-segment"},null,-1),i("div",{class:"yin-gap"},null,-1),i("div",{class:"yin-segment"},null,-1)])])):r("",!0)],2))}),[["__scopeId","data-v-c5effd2c"]]),R={class:"base-result-layout"},B=x(e({__name:"BaseResultLayout",setup:a=>(a,e)=>(o(),l("div",R,[d(a.$slots,"default",{},void 0)]))}),[["__scopeId","data-v-bb8ae905"]]),G={class:"hexagram-info"},S={class:"hexagram-line"},E={class:"hexagram-value"},F={class:"hexagram-line"},Z={class:"hexagram-value"},q={key:0,class:"hexagram-line"},P={class:"hexagram-value"},U={key:1,class:"hexagram-line"},V={class:"hexagram-value"},O={key:2,class:"hexagram-line"},Q={class:"hexagram-value"},W={class:"paipan-section"},J={class:"hexagram-container"},K={class:"main-hexagram"},X={class:"six-god"},aa={class:"change-mark"},ea={key:0},sa={class:"yao-info"},na={class:"void-mark"},ta={class:"world-response"},la={class:"changed-hexagram"},ia={class:"yao-info"},ra=x(e({__name:"LiuyaoResult",props:{data:{}},setup(a){const e=a,{formatSolarTime:s,formatGanZhi:n}=b(p(e,"data")),{reversedYaosDetail:t}=T(p(e,"data"));return(a,e)=>(o(),m(B,null,{default:g(()=>[v(j,{"solar-time":f(s),"ganzhi-time":f(n)},{default:g(()=>{var s;return[i("div",G,[i("div",S,[e[0]||(e[0]=i("span",{class:"hexagram-label"},"主卦：",-1)),i("span",E,c(a.data.originalName)+"（"+c((null==(s=a.data.palace)?void 0:s.name)||"")+"宫）",1)]),i("div",F,[e[1]||(e[1]=i("span",{class:"hexagram-label"},"变卦：",-1)),i("span",Z,c(a.data.changedName),1)]),a.data.voidBranches&&a.data.voidBranches.length>0?(o(),l("div",q,[e[2]||(e[2]=i("span",{class:"hexagram-label"},"旬空：",-1)),i("span",P,c(a.data.voidBranches.join("、")),1)])):r("",!0),a.data.interName?(o(),l("div",U,[e[3]||(e[3]=i("span",{class:"hexagram-label"},"互卦：",-1)),i("span",V,c(a.data.interName),1)])):r("",!0),a.data.changingYaos&&a.data.changingYaos.length>0?(o(),l("div",O,[e[4]||(e[4]=i("span",{class:"hexagram-label"},"动爻：",-1)),i("span",Q,[(o(!0),l(y,null,h(a.data.changingYaos,(e,s)=>(o(),l("span",{key:e.position,class:"changing-item"},"第"+c(e.position)+"爻（"+c(e.type)+"）"+c(s<a.data.changingYaos.length-1?"、":""),1))),128))])])):r("",!0)])]}),_:1},8,["solar-time","ganzhi-time"]),i("div",W,[i("div",J,[i("div",K,[(o(!0),l(y,null,h(f(t),(a,e)=>(o(),l("div",{key:e,class:"yao-line"},[i("span",X,c(a.sixGod),1),v(C,{"yao-type":a.yaoType,"is-main":!0},null,8,["yao-type"]),i("span",aa,[a.isChanging?(o(),l("span",ea,c(6===a.rawValue?"×":"●"),1)):r("",!0)]),i("span",sa,c(a.sixRelative)+c(a.najiaDizhi)+c(a.wuxing),1),i("span",na,c(a.isVoid?"空":""),1),i("span",ta,c(a.isWorld?"世":a.isResponse?"应":""),1)]))),128))]),i("div",la,[(o(!0),l(y,null,h(f(t),(a,e)=>(o(),l("div",{key:e,class:"yao-line"},[v(C,{"yao-type":a.isChanging?f(A).getChangedYaoType(a.yaoType):a.yaoType,"is-main":!1},null,8,["yao-type"]),i("span",ia,c(f(A).getChangedYaoInfo(a)),1)]))),128))])])])]),_:1}))}}),[["__scopeId","data-v-73536ae6"]]),oa={class:"hexagram-info"},da={class:"hexagram-line"},ca={class:"hexagram-value"},ua={class:"hexagram-line"},pa={class:"hexagram-value"},ma={key:0,class:"hexagram-line"},ga={class:"hexagram-value"},va={key:1,class:"hexagram-line"},ya={class:"hexagram-value"},ha={key:2,class:"hexagram-line"},fa={class:"hexagram-value"},ka={class:"paipan-section"},xa={class:"hexagram-container"},Aa={class:"main-hexagram"},_a={class:"yao-position"},$a={class:"change-mark"},Ia={key:0},wa={class:"trigram-info"},ba={key:0,class:"inter-hexagram"},Ta={class:"inter-trigram-info"},za={class:"changed-hexagram"},Ha={class:"changed-trigram-info"},La={key:0,class:"calculation-section"},Ya={class:"calculation-details"},Na=x(e({__name:"MeihuaResult",props:{data:{}},setup(a){const e=n(!1),s=a,{formatSolarTime:t,formatGanZhi:d}=b(p(s,"data")),{reversedYaosDetail:u}=T(p(s,"data")),k=a=>{var e;if(!s.data.interHexagram)return"阳";const n=s.data.yaosDetail;if(!n||n.length<6)return"阳";return(null==(e=n[[2,3,4,3,4,5][a-1]-1])?void 0:e.yaoType)||"阳"};return(a,n)=>(o(),m(B,null,{default:g(()=>[v(j,{"solar-time":f(t),"ganzhi-time":f(d)},{default:g(()=>{var e,s,t,d;return[i("div",oa,[i("div",da,[n[0]||(n[0]=i("span",{class:"hexagram-label"},"主卦：",-1)),i("span",ca,c(a.data.originalName)+"（"+c(null==(e=a.data.upperTrigram)?void 0:e.name)+c(null==(s=a.data.upperTrigram)?void 0:s.element)+"-"+c(null==(t=a.data.lowerTrigram)?void 0:t.name)+c(null==(d=a.data.lowerTrigram)?void 0:d.element)+"）",1)]),i("div",ua,[n[1]||(n[1]=i("span",{class:"hexagram-label"},"变卦：",-1)),i("span",pa,c(a.data.changedName),1)]),a.data.interName?(o(),l("div",ma,[n[2]||(n[2]=i("span",{class:"hexagram-label"},"互卦：",-1)),i("span",ga,c(a.data.interName),1)])):r("",!0),a.data.movingYao?(o(),l("div",va,[n[3]||(n[3]=i("span",{class:"hexagram-label"},"动爻：",-1)),i("span",ya,c(a.data.movingYao.yaoName)+"（"+c(a.data.movingYao.description)+"）",1)])):r("",!0),a.data.elementAnalysis?(o(),l("div",ha,[n[4]||(n[4]=i("span",{class:"hexagram-label"},"五行：",-1)),i("span",fa,c(a.data.elementAnalysis.upperElement)+"-"+c(a.data.elementAnalysis.lowerElement)+"（"+c(a.data.elementAnalysis.relation)+"）",1)])):r("",!0)])]}),_:1},8,["solar-time","ganzhi-time"]),i("div",ka,[i("div",xa,[i("div",Aa,[(o(!0),l(y,null,h(f(u),(a,e)=>{return o(),l("div",{key:e,class:"yao-line"},[i("span",_a,c((s=a.position,["初","二","三","四","五","上"][s-1]||"未知")),1),v(C,{"yao-type":a.yaoType,"is-main":!0},null,8,["yao-type"]),i("span",$a,[a.isChanging?(o(),l("span",Ia,"●")):r("",!0)]),i("span",wa,c(a.trigram)+c(a.trigramElement),1)]);var s}),128))]),a.data.interName?(o(),l("div",ba,[(o(!0),l(y,null,h(f(u),(a,e)=>{return o(),l("div",{key:e,class:"yao-line"},[v(C,{"yao-type":k(a.position),"is-main":!1},null,8,["yao-type"]),i("span",Ta,c((n=a.position,s.data.interHexagram?n<=3?s.data.interHexagram.lower:s.data.interHexagram.upper:"")),1)]);var n}),128))])):r("",!0),i("div",za,[(o(!0),l(y,null,h(f(u),(a,e)=>{return o(),l("div",{key:e,class:"yao-line"},[v(C,{"yao-type":a.isChanging?f(A).getChangedYaoType(a.yaoType):a.yaoType,"is-main":!1},null,8,["yao-type"]),i("span",Ha,c((n=a.position,s.data.changedHexagram?n<=3?s.data.changedHexagram.lower:s.data.changedHexagram.upper:"")),1)]);var n}),128))])])]),a.data.calculation&&e.value?(o(),l("div",La,[n[6]||(n[6]=i("div",{class:"calculation-title"},"起卦数据",-1)),i("div",Ya,[i("span",null,"年支"+c(a.data.calculation.yearZhi)+"("+c(a.data.calculation.yearZhiIndex)+")",1),i("span",null,"月"+c(a.data.calculation.month),1),i("span",null,"日"+c(a.data.calculation.day),1),i("span",null,"时支"+c(a.data.calculation.timeZhi)+"("+c(a.data.calculation.timeZhiIndex)+")",1),n[5]||(n[5]=i("span",null,"→",-1)),i("span",null,"上卦"+c(a.data.calculation.upperTrigramIndex),1),i("span",null,"下卦"+c(a.data.calculation.lowerTrigramIndex),1),i("span",null,"动爻"+c(a.data.calculation.movingYaoIndex),1)])])):r("",!0)]),_:1}))}}),[["__scopeId","data-v-c49c8099"]]),ja={class:"qimen-result"},Da={class:"basic-info"},Ma={class:"info-line"},Ca={class:"info-value"},Ra={class:"info-line"},Ba={class:"info-value"},Ga={class:"info-line"},Sa={class:"info-value"},Ea={class:"info-line"},Fa={class:"info-value"},Za={class:"paipan-section"},qa={class:"jiugong-container"},Pa={class:"jiugong-grid"},Ua={class:"gong-header"},Va={class:"gong-name"},Oa={class:"gong-direction"},Qa={class:"gong-content"},Wa={class:"tian-pan"},Ja={class:"star"},Ka={class:"stem"},Xa={key:0,class:"ren-pan"},ae={class:"door"},ee={class:"di-pan"},se={class:"stem"},ne={key:1,class:"shen-pan"},te={class:"god"},le={key:2,class:"zhong-gong"},ie=x(e({__name:"QimenResult",props:{data:{}},setup(a){const e=a;function n(a){if(!a||!a.solar)return"";const{solar:e}=a;return`${e.year}年${e.month}月${e.day}日 ${e.hour}时${e.minute}分`}const t=s(()=>{if(!e.data.jiuGongGe)return[];const a=e.data.jiuGongGe;return[3,8,1,2,4,6,7,0,5].map(e=>a[e]).filter(Boolean)});function d(a){return["top-left","top-center","top-right","middle-left","middle-center","middle-right","bottom-left","bottom-center","bottom-right"][a]||""}return(a,e)=>{return o(),l("div",ja,[i("div",Da,[i("div",Ma,[e[0]||(e[0]=i("span",{class:"info-label"},"起卦时间：",-1)),i("span",Ca,c(n(a.data.timeInfo)),1)]),i("div",Ra,[e[1]||(e[1]=i("span",{class:"info-label"},"干支信息：",-1)),i("span",Ba,c((s=a.data.ganzhi,s?s.formatted?s.formatted:`${s.year}年 ${s.month}月 ${s.day}日 ${s.hour}时`:"")),1)]),i("div",Ga,[e[2]||(e[2]=i("span",{class:"info-label"},"遁甲局数：",-1)),i("span",Sa,c(a.data.isYangDun?"阳遁":"阴遁")+c(a.data.juShu)+"局",1)]),i("div",Ea,[e[3]||(e[3]=i("span",{class:"info-label"},"值符值使：",-1)),i("span",Fa,c(a.data.zhiFu)+" "+c(a.data.zhiShi),1)])]),i("div",Za,[i("div",qa,[i("div",Pa,[(o(!0),l(y,null,h(t.value,(a,s)=>(o(),l("div",{key:s,class:u(["gong-cell",d(s)])},[i("div",Ua,[i("span",Va,c(a.name),1),i("span",Oa,c(a.direction),1)]),i("div",Qa,[i("div",Wa,[i("span",Ja,c(a.tianPan.star),1),i("span",Ka,c(a.tianPan.stem),1)]),a.name.includes("中五宫")?r("",!0):(o(),l("div",Xa,[i("span",ae,c(a.renPan.door),1)])),i("div",ee,[i("span",se,c(a.diPan.stem),1)]),a.name.includes("中五宫")?r("",!0):(o(),l("div",ne,[i("span",te,c(a.shenPan.god),1)])),a.name.includes("中五宫")?(o(),l("div",le,[...e[4]||(e[4]=[i("span",{class:"zhong-text"},"中宫",-1)])])):r("",!0)])],2))),128))])])])]);var s}}}),[["__scopeId","data-v-dafe056d"]]),re={key:0,class:"ssgw-info"},oe={class:"info-item"},de={class:"value"},ce={class:"info-item"},ue={class:"value"},pe={class:"info-item poem"},me={class:"poem-content"},ge={key:0,class:"info-item story"},ve={class:"story-content"},ye={key:1,class:"details-grid"},he={class:"detail-key"},fe={class:"detail-value"},ke=x(e({__name:"SsgwResult",props:{data:{}},setup:a=>(a,e)=>a.data?(o(),l("div",re,[i("div",oe,[e[0]||(e[0]=i("span",{class:"label"},"签号：",-1)),i("span",de,"第"+c(a.data.number)+"签",1)]),i("div",ce,[e[1]||(e[1]=i("span",{class:"label"},"签名：",-1)),i("span",ue,c(a.data.title),1)]),i("div",pe,[i("div",me,c(a.data.poem),1)]),a.data.story?(o(),l("div",ge,[e[2]||(e[2]=i("span",{class:"label"},"签文故事：",-1)),i("div",ve,c(a.data.story),1)])):r("",!0),a.data.details?(o(),l("div",ye,[(o(!0),l(y,null,h(a.data.details,(a,e)=>(o(),l("div",{key:e,class:"detail-item"},[i("div",he,c(e),1),i("div",fe,c(a),1)]))),128))])):r("",!0)])):r("",!0)}),[["__scopeId","data-v-327106ee"]]),xe={class:"tarot-result"},Ae={key:0,class:"spread-header"},_e={class:"spread-title"},$e={class:"spread-info"},Ie={class:"card-image"},we=["src","alt"],be={class:"card-position"},Te={key:0,class:"card-reversed"},ze={class:"card-info"},He={class:"card-name"},Le={class:"card-keywords"},Ye={key:1,class:"spread-explanation"},Ne={class:"explanation-grid"},je={class:"position-number"},De={class:"position-name"},Me={class:"card-summary"},Ce=x(e({__name:"TarotResult",props:{cards:{},type:{},spreadType:{},spreadName:{},timestamp:{},showExplanation:{type:Boolean}},setup(a){const e=a,n=s(()=>{const a=e.cards.length;switch(e.spreadType){case"single":return"layout-single";case"three":return"layout-three";case"love":return"layout-love";case"career":return"layout-career";case"decision":return"layout-decision";case"celtic":return"layout-celtic";case"chakra":return"layout-chakra";case"year":return"layout-year";default:return 1===a?"layout-single":3===a?"layout-three":a<=6?"layout-grid":a<=10?"layout-complex":"layout-large-complex"}});function t(a){return"celtic"===e.spreadType?`celtic-position-${a}`:""}function d(a){switch(e.spreadType){case"celtic":return[{gridArea:"2 / 2"},{gridArea:"2 / 2",transform:"rotate(90deg)",zIndex:2},{gridArea:"3 / 2"},{gridArea:"1 / 2"},{gridArea:"2 / 1"},{gridArea:"2 / 3"},{gridArea:"1 / 4"},{gridArea:"2 / 4"},{gridArea:"3 / 4"},{gridArea:"4 / 4"}][a]||{};case"love":return[{gridArea:"2 / 2"},{gridArea:"2 / 3"},{gridArea:"1 / 2 / 1 / 4"},{gridArea:"3 / 1"},{gridArea:"3 / 4"}][a]||{};case"decision":return[{gridArea:"2 / 2"},{gridArea:"1 / 1"},{gridArea:"3 / 1"},{gridArea:"1 / 3"},{gridArea:"3 / 3"},{gridArea:"4 / 2"}][a]||{};case"chakra":return{order:7-a};default:return{}}}function p(a){if(!a)return"";return new Date(a).toLocaleString("zh-CN")}function m(a){a.target.src="/tarot/card-back.jpg"}return(a,e)=>(o(),l("div",xe,[a.spreadName?(o(),l("div",Ae,[i("h3",_e,c(a.spreadName),1),i("p",$e,c(a.cards.length)+"张牌 · "+c(p(a.timestamp)),1)])):r("",!0),i("div",{class:u(["cards-layout",n.value])},[(o(!0),l(y,null,h(a.cards,(a,e)=>(o(),l("div",{key:e,class:u(["tarot-card",t(e)]),style:k(d(e))},[i("div",Ie,[i("img",{src:`/tarot/${a.id}.jpg`,alt:a.name,class:u({reversed:a.reversed}),onError:m},null,42,we),i("div",be,c(a.position),1),a.reversed?(o(),l("div",Te,"逆位")):r("",!0)]),i("div",ze,[i("h4",He,c(a.name),1),i("p",Le,c(a.keywords),1)])],6))),128))],2),a.showExplanation&&a.cards.length>1?(o(),l("div",Ye,[e[0]||(e[0]=i("h4",null,"牌阵解读说明",-1)),i("div",Ne,[(o(!0),l(y,null,h(a.cards,(a,e)=>(o(),l("div",{key:e,class:"explanation-item"},[i("span",je,c(e+1),1),i("span",De,c(a.position),1),i("span",Me,c(a.name)+c(a.reversed?"(逆位)":""),1)]))),128))])])):r("",!0)]))}}),[["__scopeId","data-v-6c9ab3f3"]]),Re={class:"content-card"},Be={class:"result-header"},Ge={class:"section-title"},Se={key:0,class:"result-content"},Ee={key:1,class:"ai-content"},Fe={class:"ai-header"},Ze={class:"ai-title"},qe={class:"ai-response-content"},Pe={key:0,class:"conversation-history"},Ue={key:0,class:"loading-dots"},Ve={key:0,class:"disclaimer"},Oe={key:2,class:"error-state"},Qe={class:"error-content"},We={class:"error-line-2"},Je={class:"error-line-3"},Ke={class:"result-actions"},Xe=x(e({__name:"DivinationResult",props:{type:{},result:{},title:{default:""},isAiLoading:{type:Boolean,default:!1},error:{default:null},question:{default:""},conversationHistory:{default:()=>[]},isFollowUpLoading:{type:Boolean,default:!1}},emits:["retry"],setup(a,{emit:e}){const n=a,t=s(()=>{const a=n.conversationHistory.filter(a=>"assistant"===a.role),e=a[a.length-1];return(n.isAiLoading||n.isFollowUpLoading)&&e&&!f(e.content)?"AI正在思考...":"AI深度解读"}),p=s(()=>{var a,e,s;if(n.title)return n.title;if("tarot"===n.type||"tarot_single"===n.type){const t=null==(a=n.result.data)?void 0:a.spreadName;if(t)return`塔罗牌·${t}结果`;const l=(null==(s=null==(e=n.result.data)?void 0:e.cards)?void 0:s.length)||0;return 1===l?"塔罗牌·单牌指引结果":3===l?"塔罗牌·时间流牌阵结果":"塔罗牌占卜结果"}const t={liuyao:"六爻占卜结果",meihua:"梅花易数结果",qimen:"奇门遁甲结果",ssgw:"三山国王灵签结果"};return n.type in t?t[n.type]:"占卜结果"}),g=s(()=>"liuyao"===n.type),v=s(()=>"meihua"===n.type),k=s(()=>"qimen"===n.type),x=s(()=>["tarot","tarot_single"].includes(n.type)),A=s(()=>"ssgw"===n.type);return(a,e)=>{var s,n,_,$;return o(),l("div",Re,[i("div",Be,[i("h2",Ge,c(p.value),1)]),a.result.data?(o(),l("div",Se,[g.value?(o(),m(f(ra),{key:0,data:a.result.data},null,8,["data"])):r("",!0),v.value?(o(),m(f(Na),{key:1,data:a.result.data},null,8,["data"])):r("",!0),k.value?(o(),m(f(ie),{key:2,data:a.result.data},null,8,["data"])):r("",!0),x.value?(o(),m(f(Ce),{key:3,cards:((null==(s=a.result.data)?void 0:s.cards)||[]).map(a=>({...a,keywords:Array.isArray(a.keywords)?a.keywords.join(", "):a.keywords})),type:a.type,"spread-type":null==(n=a.result.data)?void 0:n.spreadType,"spread-name":null==(_=a.result.data)?void 0:_.spreadName,timestamp:null==($=a.result.data)?void 0:$.timestamp,"show-explanation":!0},null,8,["cards","type","spread-type","spread-name","timestamp"])):r("",!0),A.value?(o(),m(f(ke),{key:4,data:a.result.data},null,8,["data"])):r("",!0)])):r("",!0),a.conversationHistory.length>0||a.isAiLoading?(o(),l("div",Ee,[i("div",Fe,[i("h3",Ze,c(t.value),1)]),i("div",qe,[a.conversationHistory.length>0?(o(),l("div",Pe,[(o(!0),l(y,null,h(a.conversationHistory.filter(a=>"system"!==a.role),(s,n)=>(o(),l("div",{key:s.id||n,class:u(["chat-message",`message-${s.role}`])},["assistant"!==s.role||f(s.content)||!a.isAiLoading&&!a.isFollowUpLoading?(o(),m(w,{key:1,content:s.content,"is-complete":!(a.isAiLoading||a.isFollowUpLoading)},null,8,["content","is-complete"])):(o(),l("div",Ue,[...e[1]||(e[1]=[i("span",null,null,-1),i("span",null,null,-1),i("span",null,null,-1)])]))],2))),128))])):r("",!0)]),a.conversationHistory.length>0&&!a.error?(o(),l("div",Ve,[...e[2]||(e[2]=[i("div",{class:"disclaimer-content"},[i("div",{class:"disclaimer-icon"},"⚠️"),i("div",{class:"disclaimer-text"}," 请注意：本次占卜仅为根据您提供的有限信息进行的推演，旨在提供一种思考和决策的辅助视角，而非绝对的未来预测。请结合您的实际情况，理性参考，自主决策。命运终究掌握在自己手中。 ")],-1)])])):r("",!0)])):r("",!0),a.error?(o(),l("div",Oe,[i("div",Qe,[e[3]||(e[3]=i("div",{class:"error-line-1"},"哈哈，AI开小差咯",-1)),i("div",We,c(a.error),1),i("div",Je,[d(a.$slots,"error-actions",{},()=>[i("button",{class:"retry-button",onClick:e[0]||(e[0]=e=>a.$emit("retry"))},"重新生成解读")])])])])):r("",!0),i("div",Ke,[d(a.$slots,"actions",{},void 0)])])}}}),[["__scopeId","data-v-0d43386e"]]);export{Xe as D};
