import{d as C,N as k,O as h,l as x,c as i,b as t,a as S,y as r,h as M,P as E,s as o,n as u,z as v,Q as K,F as V,r as O,t as f,u as w,e as n,_ as N}from"./index-xHaJBDbl.js";const U={class:"page-container"},z={class:"content-card"},B={class:"form-group"},T={class:"form-label"},$=["disabled"],q=["disabled"],D={class:"model-selection-wrapper"},F=["disabled"],L=["value"],R=["disabled"],Q={key:0},j={key:1},G={class:"form-hint"},H={key:0,class:"error-text"},J={key:1,class:"debug-text"},W={key:2},X=C({__name:"ApiKeyView",setup(Y){const A=w(),m=k(),{fetchAvailableModels:b,updateSettings:g,resetSettings:y}=m,{settings:e,isLoadingModels:p,error:c}=h(m),d=x(null);async function I(){if(!e.value.customApiKey||!e.value.customApiEndpoint){c.value="请先填写API密钥和端点";return}d.value=`正在从 ${e.value.customApiEndpoint} 获取模型列表...`;const l=await b(e.value.customApiEndpoint,e.value.customApiKey);l&&l.length>0?(d.value=`成功获取到 ${l.length} 个模型`,l.includes(e.value.selectedModel)||(e.value.selectedModel=l[0])):d.value="获取模型列表失败或列表为空。"}function P(){try{g(e.value),alert("设置已保存"),A.push("/")}catch(l){console.error("保存设置失败:",l),alert(`保存设置失败: ${l instanceof Error?l.message:"未知错误"}`)}}function _(){y(),alert("设置已重置")}return(l,s)=>(n(),i("div",U,[s[12]||(s[12]=t("h1",{class:"page-title"},"配置 Key ⚙️",-1)),t("div",z,[s[11]||(s[11]=t("h2",{class:"section-title"},"API 配置",-1)),t("div",B,[t("label",T,[r(t("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>o(e).useCustomApi=a),type:"checkbox",class:"form-checkbox"},null,512),[[E,o(e).useCustomApi]]),s[4]||(s[4]=M(" 启用自定义 API "))]),s[5]||(s[5]=t("div",{class:"form-hint"},"启用后将使用您自己的 API，否则使用内置 AI 服务",-1))]),t("div",{class:u(["form-group",{"form-disabled":!o(e).useCustomApi}])},[s[6]||(s[6]=t("label",{class:"form-label"},"API 密钥",-1)),r(t("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>o(e).customApiKey=a),type:"text",class:"form-input",placeholder:"输入您的 API Key",disabled:!o(e).useCustomApi},null,8,$),[[v,o(e).customApiKey]]),s[7]||(s[7]=t("div",{class:"form-hint"},"请输入与 OpenAI 格式兼容的 API 密钥",-1))],2),t("div",{class:u(["form-group",{"form-disabled":!o(e).useCustomApi}])},[s[8]||(s[8]=t("label",{class:"form-label"},"API 端点",-1)),r(t("input",{"onUpdate:modelValue":s[2]||(s[2]=a=>o(e).customApiEndpoint=a),type:"text",class:"form-input",placeholder:"https://api.example.com/v1",disabled:!o(e).useCustomApi},null,8,q),[[v,o(e).customApiEndpoint]]),s[9]||(s[9]=t("div",{class:"form-hint"},"请输入基础API地址，系统会自动添加 /chat/completions 路径",-1))],2),t("div",{class:u(["form-group",{"form-disabled":!o(e).useCustomApi}])},[s[10]||(s[10]=t("label",{class:"form-label"},"选择模型",-1)),t("div",D,[r(t("select",{"onUpdate:modelValue":s[3]||(s[3]=a=>o(e).selectedModel=a),class:"form-select",disabled:!o(e).useCustomApi},[(n(!0),i(V,null,O(o(e).availableModels,a=>(n(),i("option",{key:a,value:a},f(a),9,L))),128))],8,F),[[K,o(e).selectedModel]]),t("button",{class:u(["btn-primary fetch-models-button",{loading:o(p)}]),disabled:!o(e).useCustomApi||!o(e).customApiKey||!o(e).customApiEndpoint||o(p),onClick:I},[o(p)?(n(),i("span",Q,"加载中...")):(n(),i("span",j,"获取模型列表"))],10,R)]),t("div",G,[o(c)?(n(),i("span",H,f(o(c)),1)):d.value?(n(),i("span",J,f(d.value),1)):(n(),i("span",W,"选择要使用的模型，或从您的API提供商获取可用模型列表"))])],2),t("div",{class:"form-actions"},[t("button",{class:"btn-primary",onClick:P},"保存设置"),t("button",{class:"btn-secondary",onClick:_},"重置")])]),s[13]||(s[13]=S('<div class="content-card" data-v-7cdfa50f><h2 class="section-title" data-v-7cdfa50f>使用说明</h2><div class="info-content" data-v-7cdfa50f><p data-v-7cdfa50f>您可以配置兼容 OpenAI 格式的 API，包括但不限于：</p><ul data-v-7cdfa50f><li data-v-7cdfa50f>OpenAI API</li><li data-v-7cdfa50f>Azure OpenAI</li><li data-v-7cdfa50f>自托管的开源模型 API</li><li data-v-7cdfa50f>其他兼容 OpenAI 格式的 API 服务</li></ul><p data-v-7cdfa50f><strong data-v-7cdfa50f>注意：</strong> API 密钥将安全地存储在您的浏览器本地，不会发送到我们的服务器。 </p><p data-v-7cdfa50f><strong data-v-7cdfa50f>模型获取：</strong> 点击&quot;获取模型列表&quot;按钮将从您配置的API端点获取可用的模型列表。 如果获取失败，将使用默认模型列表。 </p></div></div>',1))]))}}),ss=N(X,[["__scopeId","data-v-7cdfa50f"]]);export{ss as default};
