import{d as s,Q as e,r as l,c as a,b as t,j as o,h as i,R as n,u,n as c,v as d,k as p,F as r,l as m,t as A,x as v,e as b}from"./vendor-BUyyYNCK.js";import{u as f,_ as y}from"./index-1KWhz6Xq.js";import"./utils-CwRxlNlL.js";const h={class:"page-container"},g={class:"content-card"},I={class:"form-group"},P={class:"form-label"},k=["disabled"],C=["disabled"],x={class:"model-selection-wrapper"},K=["disabled"],E=["value"],M=["disabled"],V={key:0},_={key:1},j={class:"form-hint"},U={key:0,class:"error-text"},w={key:1,class:"debug-text"},$={key:2},O=y(s({__name:"ApiKeyView",setup(s){const y=v(),O=f(),{fetchAvailableModels:S,updateSettings:F,resetSettings:L}=O,{settings:Q,isLoadingModels:R,error:q}=e(O),z=l(null);async function B(){if(!Q.value.customApiKey||!Q.value.customApiEndpoint)return void(q.value="请先填写API密钥和端点");z.value=`正在从 ${Q.value.customApiEndpoint} 获取模型列表...`;const s=await S(Q.value.customApiEndpoint,Q.value.customApiKey);s&&s.length>0?(z.value=`成功获取到 ${s.length} 个模型`,s.includes(Q.value.selectedModel)||(Q.value.selectedModel=s[0])):z.value="获取模型列表失败或列表为空。"}function D(){try{F(Q.value),alert("设置已保存"),y.push("/")}catch(s){alert(`保存设置失败: ${s instanceof Error?s.message:"未知错误"}`)}}function G(){L(),alert("设置已重置")}return(s,e)=>(b(),a("div",h,[e[12]||(e[12]=t("h1",{class:"page-title"},"配置 Key ⚙️",-1)),t("div",g,[e[11]||(e[11]=t("h2",{class:"section-title"},"API 配置",-1)),t("div",I,[t("label",P,[o(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>u(Q).useCustomApi=s),type:"checkbox",class:"form-checkbox"},null,512),[[n,u(Q).useCustomApi]]),e[4]||(e[4]=i(" 启用自定义 API ",-1))]),e[5]||(e[5]=t("div",{class:"form-hint"},"启用后将使用您自己的 API，否则使用内置 AI 服务",-1))]),t("div",{class:c(["form-group",{"form-disabled":!u(Q).useCustomApi}])},[e[6]||(e[6]=t("label",{class:"form-label"},"API 密钥",-1)),o(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>u(Q).customApiKey=s),type:"text",class:"form-input",placeholder:"输入您的 API Key",disabled:!u(Q).useCustomApi},null,8,k),[[d,u(Q).customApiKey]]),e[7]||(e[7]=t("div",{class:"form-hint"},"请输入与 OpenAI 格式兼容的 API 密钥",-1))],2),t("div",{class:c(["form-group",{"form-disabled":!u(Q).useCustomApi}])},[e[8]||(e[8]=t("label",{class:"form-label"},"API 端点",-1)),o(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>u(Q).customApiEndpoint=s),type:"text",class:"form-input",placeholder:"https://api.example.com/v1",disabled:!u(Q).useCustomApi},null,8,C),[[d,u(Q).customApiEndpoint]]),e[9]||(e[9]=t("div",{class:"form-hint"},"请输入基础API地址，系统会自动添加 /chat/completions 路径",-1))],2),t("div",{class:c(["form-group",{"form-disabled":!u(Q).useCustomApi}])},[e[10]||(e[10]=t("label",{class:"form-label"},"选择模型",-1)),t("div",x,[o(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>u(Q).selectedModel=s),class:"form-select",disabled:!u(Q).useCustomApi},[(b(!0),a(r,null,m(u(Q).availableModels,s=>(b(),a("option",{key:s,value:s},A(s),9,E))),128))],8,K),[[p,u(Q).selectedModel]]),t("button",{class:c(["btn-primary fetch-models-button",{loading:u(R)}]),disabled:!u(Q).useCustomApi||!u(Q).customApiKey||!u(Q).customApiEndpoint||u(R),onClick:B},[u(R)?(b(),a("span",V,"加载中...")):(b(),a("span",_,"获取模型列表"))],10,M)]),t("div",j,[u(q)?(b(),a("span",U,A(u(q)),1)):z.value?(b(),a("span",w,A(z.value),1)):(b(),a("span",$,"选择要使用的模型，或从您的API提供商获取可用模型列表"))])],2),t("div",{class:"form-actions"},[t("button",{class:"btn-primary",onClick:D},"保存设置"),t("button",{class:"btn-secondary",onClick:G},"重置")])]),e[13]||(e[13]=t("div",{class:"content-card"},[t("h2",{class:"section-title"},"使用说明"),t("div",{class:"info-content"},[t("p",null,"您可以配置所有兼容 OpenAI 格式的 API"),t("p",null,[t("strong",null,"注意："),i(" API 密钥将安全地存储在您的浏览器本地，不会发送到我们的服务器。 ")]),t("p",null,[t("strong",null,"模型获取："),i(' 点击"获取模型列表"按钮将从您配置的API端点获取可用的模型列表。 如果获取失败，将使用默认模型列表。 ')])])],-1))]))}}),[["__scopeId","data-v-84951bd4"]]);export{O as default};
