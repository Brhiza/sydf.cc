import{d as e,L as s,r as a,c as t,a as l,E as o,j as c,h as i,M as n,u as d,n as u,v as p,k as r,F as m,l as v,t as b,x as A,o as f}from"./vendor-DTFIXZ-L.js";import{u as I,_ as y}from"./index-D2_bPeI6.js";import"./utils-B-ODjm7Z.js";const h={class:"page-container"},g={class:"content-card"},P={class:"form-group"},k={class:"form-label"},C=["disabled"],x=["disabled"],E={class:"model-selection-wrapper"},K=["disabled"],M=["value"],O=["disabled"],V={key:0},_={key:1},j={class:"form-hint"},U={key:0,class:"error-text"},w={key:1,class:"debug-text"},$={key:2},q=y(e({__name:"ApiKeyView",setup(e){const y=A(),q=I(),{fetchAvailableModels:L,updateSettings:S,resetSettings:z}=q,{settings:F,isLoadingModels:B,error:D}=s(q),G=a(null);async function H(){if(!F.value.customApiKey||!F.value.customApiEndpoint)return void(D.value="请先填写API密钥和端点");G.value=`正在从 ${F.value.customApiEndpoint} 获取模型列表...`;const e=await L(F.value.customApiEndpoint,F.value.customApiKey);e&&e.length>0?(G.value=`成功获取到 ${e.length} 个模型`,e.includes(F.value.selectedModel)||(F.value.selectedModel=e[0])):G.value="获取模型列表失败或列表为空。"}function J(){try{S(F.value),alert("设置已保存"),y.push("/")}catch(e){alert(`保存设置失败: ${e instanceof Error?e.message:"未知错误"}`)}}function N(){z(),alert("设置已重置")}return(e,s)=>(f(),t("div",h,[s[12]||(s[12]=l("h1",{class:"page-title"},"配置 Key ⚙️",-1)),l("div",g,[s[11]||(s[11]=l("h2",{class:"section-title"},"API 配置",-1)),l("div",P,[l("label",k,[c(l("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>d(F).useCustomApi=e),type:"checkbox",class:"form-checkbox"},null,512),[[n,d(F).useCustomApi]]),s[4]||(s[4]=i(" 启用自定义 API ",-1))]),s[5]||(s[5]=l("div",{class:"form-hint"},"启用后将使用您自己的 API，否则使用内置 AI 服务",-1))]),l("div",{class:u(["form-group",{"form-disabled":!d(F).useCustomApi}])},[s[6]||(s[6]=l("label",{class:"form-label"},"API 密钥",-1)),c(l("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>d(F).customApiKey=e),type:"text",class:"form-input",placeholder:"输入您的 API Key",disabled:!d(F).useCustomApi},null,8,C),[[p,d(F).customApiKey]]),s[7]||(s[7]=l("div",{class:"form-hint"},"请输入与 OpenAI 格式兼容的 API 密钥",-1))],2),l("div",{class:u(["form-group",{"form-disabled":!d(F).useCustomApi}])},[s[8]||(s[8]=l("label",{class:"form-label"},"API 端点",-1)),c(l("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>d(F).customApiEndpoint=e),type:"text",class:"form-input",placeholder:"https://api.example.com/v1",disabled:!d(F).useCustomApi},null,8,x),[[p,d(F).customApiEndpoint]]),s[9]||(s[9]=l("div",{class:"form-hint"},"请输入基础API地址，系统会自动添加 /chat/completions 路径",-1))],2),l("div",{class:u(["form-group",{"form-disabled":!d(F).useCustomApi}])},[s[10]||(s[10]=l("label",{class:"form-label"},"选择模型",-1)),l("div",E,[c(l("select",{"onUpdate:modelValue":s[3]||(s[3]=e=>d(F).selectedModel=e),class:"form-select",disabled:!d(F).useCustomApi},[(f(!0),t(m,null,v(d(F).availableModels,e=>(f(),t("option",{key:e,value:e},b(e),9,M))),128))],8,K),[[r,d(F).selectedModel]]),l("button",{class:u(["btn-primary fetch-models-button",{loading:d(B)}]),disabled:!d(F).useCustomApi||!d(F).customApiKey||!d(F).customApiEndpoint||d(B),onClick:H},[d(B)?(f(),t("span",V,"加载中...")):(f(),t("span",_,"获取模型列表"))],10,O)]),l("div",j,[d(D)?(f(),t("span",U,b(d(D)),1)):G.value?(f(),t("span",w,b(G.value),1)):(f(),t("span",$,"选择要使用的模型，或从您的API提供商获取可用模型列表"))])],2),l("div",{class:"form-actions"},[l("button",{class:"btn-primary",onClick:J},"保存设置"),l("button",{class:"btn-secondary",onClick:N},"重置")])]),s[13]||(s[13]=o('<div class="content-card" data-v-b8e618cc><h2 class="section-title" data-v-b8e618cc>使用说明</h2><div class="info-content" data-v-b8e618cc><p data-v-b8e618cc>您可以配置兼容 OpenAI 格式的 API，包括但不限于：</p><ul data-v-b8e618cc><li data-v-b8e618cc>OpenAI API</li><li data-v-b8e618cc>Azure OpenAI</li><li data-v-b8e618cc>自托管的开源模型 API</li><li data-v-b8e618cc>其他兼容 OpenAI 格式的 API 服务</li></ul><p data-v-b8e618cc><strong data-v-b8e618cc>注意：</strong> API 密钥将安全地存储在您的浏览器本地，不会发送到我们的服务器。 </p><p data-v-b8e618cc><strong data-v-b8e618cc>模型获取：</strong> 点击&quot;获取模型列表&quot;按钮将从您配置的API端点获取可用的模型列表。 如果获取失败，将使用默认模型列表。 </p></div></div>',1))]))}}),[["__scopeId","data-v-b8e618cc"]]);export{q as default};
