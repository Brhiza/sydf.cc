import{d as a,o as t,a as e,l as s,p as l,T as i,E as n,G as o,e as d,c,f as r,b as u,r as v,D as m,g,t as h,n as p,F as b,k as f}from"./vendor-cAEEXcX9.js";import{_ as k}from"./index-CqUvQr7Y.js";import"./utils-CwRxlNlL.js";const y={class:"modal-content"},w={class:"image-container"},L=["src","alt"],x=k(a({__name:"ImageModal",props:{imageUrl:{},isVisible:{type:Boolean},title:{}},emits:["close","image-loaded","image-error"],setup(a,{emit:v}){const m=v;function g(){m("close")}function h(a){a.target===a.currentTarget&&g()}function p(a){"Escape"===a.key&&g()}return t(()=>{document.addEventListener("keydown",p)}),e(()=>{document.removeEventListener("keydown",p)}),(t,e)=>(d(),s(o,{to:"body"},[l(i,{name:"modal"},{default:n(()=>[a.isVisible?(d(),c("div",{key:0,class:"modal-backdrop",onClick:h},[u("div",y,[u("button",{class:"close-button","aria-label":"关闭",onClick:g},[...e[2]||(e[2]=[u("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[u("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])]),u("div",w,[u("img",{src:a.imageUrl,alt:a.title||"证书图片",class:"certificate-image",onLoad:e[0]||(e[0]=a=>t.$emit("image-loaded")),onError:e[1]||(e[1]=a=>t.$emit("image-error"))},null,40,L)])])])):r("",!0)]),_:1})]))}}),[["__scopeId","data-v-46b23c7b"]]),_={class:"page-container"},j={class:"content-card"},C={class:"stats-container"},U={class:"stat-item"},M={class:"stat-number"},V={class:"stat-item"},E={class:"stat-number"},T={class:"stat-item"},B={class:"stat-number"},D={class:"content-card"},z={class:"section-header"},$={class:"section-title"},A=["disabled","title"],I={class:"table-container"},q={class:"certificate-table"},G={key:0,class:"anonymous-badge"},S={key:1},F={class:"amount-cell"},H={class:"link-cell"},N=["onClick"],P={key:1,class:"no-certificate"},J={key:0},K={class:"total-row"},O={colspan:"3",class:"amount-cell"},Q={key:0,class:"empty-state"},R=k(a({__name:"GongdeBoxView",setup(a){const e=v([]),s=v({url:"https://cdn.jsdelivr.net/gh/Brhiza/sydfjuanzeng@main/zhengshu.json",isLoading:!1,error:null}),i=v({isVisible:!1,imageUrl:"",title:""});function n(a){return`¥${a.toLocaleString()}`}function o(){return e.value.reduce((a,t)=>a+t.amount,0)}function k(){return e.value.length}async function y(){s.value.isLoading=!0,s.value.error=null;try{const a=await fetch(s.value.url);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const t=await a.json();e.value=t}catch(a){s.value.error="获取远程数据失败，使用本地数据"}finally{s.value.isLoading=!1}}function w(){i.value.isVisible=!1,i.value.imageUrl="",i.value.title=""}function L(a){a.preventDefault()}function R(a){a.preventDefault(),y()}return t(()=>{y()}),(a,t)=>(d(),c("div",_,[t[10]||(t[10]=m('<h1 class="page-title" data-v-d22d9443>功德箱 🙏</h1><div class="content-card" data-v-d22d9443><div class="donation-container" data-v-d22d9443><div class="merit-box-section" data-v-d22d9443><img src="/static/gongdexiang.jpg" alt="功德箱" class="merit-box-image" data-v-d22d9443></div><div class="payment-methods" data-v-d22d9443><div class="payment-method" data-v-d22d9443><img src="/static/alipay.png" alt="支付宝收款码" class="qrcode-image" data-v-d22d9443><p class="donation-hint" data-v-d22d9443>支付宝扫码捐赠</p></div><div class="payment-method" data-v-d22d9443><img src="/static/wechat.png" alt="微信收款码" class="qrcode-image" data-v-d22d9443><p class="donation-hint" data-v-d22d9443>微信扫码捐赠</p></div></div><div class="merit-box-link" data-v-d22d9443><a href="/#/gongdeboard" data-v-d22d9443> 🙏 功德榜 </a></div></div></div>',2)),u("div",j,[t[3]||(t[3]=u("h2",{class:"section-title"},[g("功德统计 "),u("span",{class:"highlight-text"},"爱心汇聚")],-1)),u("div",C,[u("div",U,[u("div",M,h(o()),1),t[0]||(t[0]=u("div",{class:"stat-label"},"总捐赠额 (元)",-1))]),u("div",V,[u("div",E,h(k()),1),t[1]||(t[1]=u("div",{class:"stat-label"},"捐赠次数",-1))]),u("div",T,[u("div",B,h(Math.round(o()/k())),1),t[2]||(t[2]=u("div",{class:"stat-label"},"次均捐赠 (元)",-1))])])]),u("div",D,[u("div",z,[u("h2",$,[t[5]||(t[5]=g(" 捐赠证书 ",-1)),u("button",{class:"refresh-button",disabled:s.value.isLoading,title:s.value.isLoading?"正在刷新...":"点击刷新数据",type:"button",onClick:y,onTouchstart:L,onTouchend:R},[(d(),c("svg",{class:p(["refresh-icon",{rotating:s.value.isLoading}]),viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[...t[4]||(t[4]=[u("path",{d:"M1 4v6h6M23 20v-6h-6"},null,-1),u("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"},null,-1)])],2))],40,A)])]),t[9]||(t[9]=u("div",{class:"refresh-notice"},[u("p",null,"💡 数据更新可能存在延迟，如需查看最新捐赠记录，请点击上方刷新按钮")],-1)),u("div",I,[u("table",q,[t[7]||(t[7]=u("thead",null,[u("tr",null,[u("th",null,"序号"),u("th",null,"捐赠项目"),u("th",null,"金额"),u("th",null,"日期"),u("th",null,"链接")])],-1)),u("tbody",null,[(d(!0),c(b,null,f(e.value,(a,t)=>{return d(),c("tr",{key:a.id},[u("td",null,h(t+1),1),u("td",null,[a.isAnonymous?(d(),c("span",G,"🙈 匿名捐赠")):(d(),c("span",S,h(a.name||"爱心捐赠"),1))]),u("td",F,h(n(a.amount)),1),u("td",null,h((e=a.date,new Date(e).toLocaleDateString("zh-CN"))),1),u("td",H,[a.certificateUrl?(d(),c("button",{key:0,class:"view-certificate-btn",onClick:t=>{return e=a.certificateUrl,s=a.name?a.name+"的捐赠证书":"捐赠证书",void(i.value={isVisible:!0,imageUrl:e,title:s||"捐赠证书"});var e,s}}," 查看证书 ",8,N)):(d(),c("span",P,"暂无证书"))])]);var e}),128))]),e.value.length>0?(d(),c("tfoot",J,[u("tr",K,[t[6]||(t[6]=u("td",{colspan:"2"},[u("strong",null,"总计")],-1)),u("td",O,[u("strong",null,h(n(o())),1)])])])):r("",!0)]),0===e.value.length?(d(),c("div",Q,[...t[8]||(t[8]=[u("div",{class:"empty-icon"},"📋",-1),u("p",null,"暂无捐赠记录",-1)])])):r("",!0)])]),l(x,{"image-url":i.value.imageUrl,"is-visible":i.value.isVisible,title:i.value.title,onClose:w},null,8,["image-url","is-visible","title"])]))}}),[["__scopeId","data-v-d22d9443"]]);export{R as default};
