<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>八字</title>
    <link rel="icon" href="static/favicon.ico" type="image/x-icon">
    <link rel="icon" href="static/favicon.png" type="image/png">
    <link rel="apple-touch-icon" sizes="180x180" href="static/apple-touch-icon.png">
    <link rel="stylesheet" href="css/paipan.css">
</head>
<body>
    <div class="container">
        <h1>八字</h1>
        
        <div>
            <label for="name">姓名</label>
            <input type="text" id="name" name="name" placeholder="选填" style="width: 100%; padding: 12px; margin-bottom: 20px; border: 1px solid #d1d9e6; border-radius: 6px; box-sizing: border-box; font-size: 16px;">
        </div>
        
        <div class="date-inputs-row">
            <div class="date-input-group">
                <label for="year">年</label>
                <input type="number" id="year" name="year" placeholder="2000" required>
            </div>
            <div class="date-input-group">
                <label for="month">月</label>
                <input type="number" id="month" name="month" min="1" max="12" placeholder="1-12" required>
            </div>
            <div class="date-input-group">
                <label for="day">日</label>
                <input type="number" id="day" name="day" min="1" max="31" placeholder="1-31" required>
            </div>
        </div>

        <div>
            <label for="hour">时辰:</label>
            <select id="hour" name="hour" required>
                <option value="0"selected>早子时 (00:00-01:00)</option>
                <option value="1">丑时 (01:00-03:00)</option>
                <option value="2">寅时 (03:00-05:00)</option>
                <option value="3">卯时 (05:00-07:00)</option>
                <option value="4">辰时 (07:00-09:00)</option>
                <option value="5">巳时 (09:00-11:00)</option>
                <option value="6">午时 (11:00-13:00)</option>
                <option value="7">未时 (13:00-15:00)</option>
                <option value="8">申时 (15:00-17:00)</option>
                <option value="9">酉时 (17:00-19:00)</option>
                <option value="10">戌时 (19:00-21:00)</option>
                <option value="11">亥时 (21:00-23:00)</option>
                <option value="12">晚子时 (23:00-24:00)</option>
            </select>
        </div>
        <div>
            <label>性别:</label>
            <div class="gender-buttons">
                <button type="button" class="gender-button" id="genderMale">男</button>
                <button type="button" class="gender-button" id="genderFemale">女</button>
            </div>
        </div>

        <div>
            <input type="checkbox" id="enableSecondPerson" onchange="toggleSecondPersonInputs()">
            <label for="enableSecondPerson" style="display: inline; margin-left: 5px;">合盘</label>
        </div>

        <div id="secondPersonInputs" style="display:none; margin-top: 20px; padding-top:20px; border-top: 1px dashed #ccc;">
            <h2>第二人信息</h2>
            <div class="date-inputs-row">
                <div class="date-input-group">
                    <label for="year2">年</label>
                    <input type="number" id="year2" name="year2" placeholder="2000">
                </div>
                <div class="date-input-group">
                    <label for="month2">月</label>
                    <input type="number" id="month2" name="month2" min="1" max="12" placeholder="1-12">
                </div>
                <div class="date-input-group">
                    <label for="day2">日</label>
                    <input type="number" id="day2" name="day2" min="1" max="31" placeholder="1-31">
                </div>
            </div>
            <div>
                <label for="hour2">时辰:</label>
                <select id="hour2" name="hour2">
                    <option value="0"selected>早子时 (00:00-01:00)</option>
                    <option value="1">丑时 (01:00-03:00)</option>
                    <option value="2">寅时 (03:00-05:00)</option>
                    <option value="3">卯时 (05:00-07:00)</option>
                    <option value="4">辰时 (07:00-09:00)</option>
                    <option value="5">巳时 (09:00-11:00)</option>
                    <option value="6">午时 (11:00-13:00)</option>
                    <option value="7">未时 (13:00-15:00)</option>
                    <option value="8">申时 (15:00-17:00)</option>
                    <option value="9">酉时 (17:00-19:00)</option>
                    <option value="10">戌时 (19:00-21:00)</option>
                    <option value="11">亥时 (21:00-23:00)</option>
                    <option value="12">晚子时 (23:00-24:00)</option>
                </select>
            </div>
            <div>
                <label>性别:</label>
                <div class="gender-buttons">
                    <button type="button" class="gender-button" id="genderMale2">男</button>
                    <button type="button" class="gender-button" id="genderFemale2">女</button>
                </div>
            </div>
        </div>

        <button class="ai-question-button" onclick="generateAstrolabe()">开始排盘</button>
        <h2>排盘结果:</h2>
        <div id="result" style="display:none;"></div>
        <div id="result2" style="margin-top: 20px; display:none;"></div>
        
        <div id="aiQuestionContainer" style="display:none;">
            <div id="aiQuestionOptions">
                <button id="ai-mingge-zonglun" class="unified-button" data-default-text="请对该命盘进行一次全面、深入、详尽的命格总论分析，内容需丰富详实。分析需严格按照以下结构展开：

1.  **命局核心提要**：
    *   **日主与五行**：分析日主的特性以及命局中五行（金木水火土）的分布、力量与平衡状况。
    *   **格局与旺衰**：明确判断八字属于何种格局（如正官格、七杀格、食神格等），并精确判断日主的强弱（旺衰）。
    *   **喜用神与忌神**：基于格局和旺衰，清晰地指出本命局的喜用神和忌神是什么，并简要说明理由。

2.  **性格、能力与天赋**：
    *   **核心性格**：根据日主、十神组合和格局，深入剖析命主最核心的性格特质，包括其思维模式、价值观和行为倾向。
    *   **先天优势**：详细描述命主与生俱来的天赋和才能，例如学习能力、社交手腕、创造力、领导力等，并说明这些优势在哪些领域最能得到发挥。
    *   **潜在挑战**：客观指出命主性格中可能存在的弱点、盲点或潜在的内在冲突，并解释这些挑战可能在生活中如何体现。

3.  **人生主要领域剖析**：
    *   **事业财运**：分析命主的事业发展方向、适合的行业领域、财富能量等级以及获取财富的主要方式。
    *   **感情婚姻**：解读命主的感情观、择偶偏好、婚姻生活的特点以及与伴侣的互动模式。
    *   **健康状况**：根据五行平衡，提示命主需要先天关注的身体部位和易发健康问题。

4.  **人生大运总览与核心建议**：
    *   **大运趋势**：简要概括未来几步大运（每步大运为十年）的整体走势起伏，点明人生的几个关键转折期。
    *   **核心指导与人生课题**：综合以上所有分析，为命主提炼出最核心、最重要的人生发展建议。明确指出TA此生的主要人生课题是什么，并提供具体的、可操作的策略来帮助TA扬长避短、趋吉避凶，更好地实现人生价值。" onclick="selectOption(this, 'single')">命格总论</button>
                <button id="ai-current-luck" class="unified-button" data-default-text="请详细分析命主当前所处的这步大运。说明这步大运的干支对原局的作用（合、冲、刑、害），并结合十神和星运，解读在此期间事业、财运、感情和健康方面的主要机遇和挑战。最后，提供针对性的行事建议。" onclick="selectOption(this, 'single')">当前大运</button>
                <button id="ai-this-year" class="unified-button" data-default-text="请详细分析命主在今年的流年运势。说明流年干支与命局、大运的相互作用。重点解读事业、财运、感情、健康四个方面的具体情况，并指出需要特别注意的月份和关键的转折点。" onclick="selectOption(this, 'single')">今年运势</button>
                <button id="ai-year-analysis" class="unified-button" data-default-text="请分析我今年的年运，并详细解读每个农历月的运势。" onclick="selectOption(this, 'single')">年运分析</button>
                <button id="ai-career" class="unified-button" data-default-text="请根据以下八字信息，从【整体命格】和【当前大运】两个角度，详细分析我的事业和财运状况。在整体命格方面，请分析我的事业发展方向、适合的行业领域、财富能量等级以及获取财富的主要方式。在当前大运方面，请分析这十年事业和财运上的主要机遇和挑战，并提供针对性的行事建议。" onclick="selectOption(this, 'single')">事业财运</button>
                <button id="ai-marriage" class="unified-button" data-default-text="请根据以下八字信息，从【整体命格】和【当前大运】两个角度，详细分析我的感情和婚姻状况。在整体命格方面，请解读我的感情观、择偶偏好、婚姻生活的特点以及与伴侣的互动模式。在当前大运方面，请分析这十年感情上的主要机遇和挑战，并提供针对性的行事建议。" onclick="selectOption(this, 'single')">感情婚姻</button>
                <button id="ai-health" class="unified-button" data-default-text="请根据以下八字信息，从【整体命格】和【当前大运】两个角度，详细分析我的健康状况。在整体命格方面，请根据五行平衡，提示我需要先天关注的身体部位和易发健康问题。在当前大运方面，请分析这十年健康上的主要机遇和挑战，并提供针对性的保养建议。" onclick="selectOption(this, 'single')">健康状况</button>
                <button id="ai-next-three-years" class="unified-button" data-default-text="请分析命主在未来三年的流年运势。逐年说明运势的起伏变化，并给出每年在事业、感情、生活等方面的规划建议和注意事项。" onclick="selectOption(this, 'single')">未来三年</button>
                <button class="unified-button" onclick="showCustomInput('single'); selectOption(this, 'single');">自定义...</button>
            </div>
            <div id="customQuestionContainer" style="width: 100%; margin-top: 10px;">
                <input type="text" id="customQuestion" placeholder="请输入您的问题" style="display: none; width: 100%; padding: 12px; border: 1px solid #c5cae9; border-radius: 6px; box-sizing: border-box; font-size: 16px;">
            </div>
            <button class="ai-question-button ai-glow-button" onclick="askAI()" style="margin-top: 10px;">向 AI 提问</button>
        </div>

        <!-- 合盘分析容器 -->
        <div id="combinedAnalysisContainer" style="display:none;">
            <div id="combinedQuestionOptions">
                <button class="unified-button" data-default-text="请对这两个命盘进行婚恋匹配分析。从五行互补、十神吸引、夫妻宫互动、大运同步性等角度，系统评估双方的缘分深浅和相处模式。总结双方的匹配优势和潜在矛盾，并为促进关系和谐提供具体建议。" onclick="selectOption(this, 'combined');">婚恋匹配</button>
                <button class="unified-button" data-default-text="请对这两个命盘进行事业合作匹配分析。评估双方在性格、资源、行事风格上的互补性。分析合作过程中可能出现的机遇和矛盾点，并对如何建立长期、共赢的合作关系提供策略建议。" onclick="selectOption(this, 'combined');">事业合作</button>
                <button class="unified-button" onclick="showCustomInput('combined'); selectOption(this, 'combined');">自定义...</button>
            </div>
            <div id="customCombinedQuestionContainer" style="width: 100%; margin-top: 10px;">
                <input type="text" id="customCombinedQuestion" placeholder="请输入您的问题" style="display: none; width: 100%; padding: 12px; border: 1px solid #c5cae9; border-radius: 6px; box-sizing: border-box; font-size: 16px;">
            </div>
            <button class="ai-question-button ai-glow-button" onclick="askAIForCompatibility()" style="margin-top: 10px;">AI 合盘分析</button>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/gh/6tail/lunar-javascript@master/lunar.js"></script>
    <script src="js/ai.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/iztro@latest/dist/iztro.min.js"></script>
<script src="js/paipan/calendar.js"></script>
    <script src="js/paipan/paipan.js"></script>
    <script src="js/paipan/common.js"></script>
    <script src="js/paipan/bz.js"></script>
</body>
</html>
